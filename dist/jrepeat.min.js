!function(e){"use strict";function t(e,t){switch(typeof e){case"object":return JSON.stringify(e);case"undefined":return t?"":"undefined";case"string":return t?e:JSON.stringify(e);default:return e.toString()}}function n(t,n,i,o){if(t){i=i||{},o=o||{};var s={};for(var f in s.$self=n,i)s["$"+f]=i[f];for(var u,c={},l=/([\w]+)\s*?(\()?/g;u=l.exec(t);)u[2]&&(c[u[1]]=function(){}),c[u[1]]=void 0;var d,p=e.extend(c,"object"==typeof n?n:{},s,o),v=r(t);(d=a(v))||(d=a(v,Function("sandbox","with (sandbox) {return ("+t+"})}")));try{return d(p)}catch(e){return console.error(t),void console.error(e)}}}function r(){var e="";for(var n in arguments)e+="#"+t(arguments[n]).replace(/#/g,"##");var r=0;if(0===e.length)return r;for(n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return r}function a(e,t){return t&&(a.memory[e]=t),a.memory[e]}a.memory={},e.fn.jRepeat=function(t){var n,r=this;if((t=t||{}).templateId,!t.state)throw new Error("No state specified");var a,i=function(){return!0},o=t.state;function s(){var e=o;u("limit")&&(e=o.slice(u("page")*u("limit"),(u("page")+1)*u("limit")));for(var t="",i=0;i<e.length;i++)t+=c(f(),e[i],{index:i,page:u("page"),limit:u("limit"),length:o.length},u("functions"));return r.addClass("jrepeat-processed"),r.data("contents")!=t&&(r.data("contents",t),r.addClass("jrepeat-exit"),r.addClass("jrepeat-transitioning"),r.removeClass("jrepeat-enter"),clearTimeout(a),a=setTimeout(function(){r.removeClass("jrepeat-exit"),r.addClass("jrepeat-enter"),r[0].innerHTML=t,n.onUpdateCallback(r,n),a=setTimeout(function(){r.removeClass("jrepeat-enter"),r.removeClass("jrepeat-transitioning")},u("transitionEnter"))},50+u("transitionExit"))),n}function f(t){t&&(u("template",t),s());var n=void 0;return!n&&u("templateId")&&(n=e("#"+CSS.escape(u("templateId")))[0].innerHTML),!n&&u("tag")&&(n="<"+escape(u("tag"))+">{{$self}}</"+escape(u("tag"))+">"),!n&&u("template")&&(n=u("template")),n||(n=u("initialContent")),n}n={filter:function(e){i=e,u("page",0),n.refresh()},reset:function(){i=function(){return!0},u("page",0),n.refresh()},nextPage:function(){n.setPage(u("page")+1)},prevPage:function(){n.setPage(u("page")-1)},setPage:function(e){if(u("limit")){var t=Math.floor((o.length-1)/u("limit"));u("page",e<=t?e>=0?e:0:t)}else u("page",0);n.update()},length:function(){return o.length},update:s,updateInternal:function(){o=u("state").filter(i)},tpl:f};var u=(n=e.extend(r.jTemplate(t,{transitionExit:0,transitionEnter:0,limit:0,page:0,tag:void 0}),n)).get,c=n.renderer;return u("template",f()),n},e.fn.jTemplate=function(i,o){var s;o=o||{};var f=this,u=(i=i||{}).templateId,c=i.state;if(i.functions=i.functions||{},u?e("#"+CSS.escape(u))[0].innerHTML:i.template,!c)throw new Error("No state specified");function l(){var t=e("<div></div>");return t.append(p(d(),v("state"),{},v("functions"))),t[0].innerHTML!==f[0].innerHTML&&(f[0].innerHTML=t[0].innerHTML,s.onUpdateCallback(f,s)),s}function d(t){return t&&(v("template",t),l()),v("template")?v("template"):u?e("#"+CSS.escape(u))[0].innerHTML:f[0].innerHTML}function p(i,o,s,f){var u=r(i,o,s,f),c=a(u);return c||a(u,i=(i=function(t,r,a,i){var o=e("<div></div>");function s(e,t){for(var n=0;n<e.length;n++)t(n,e[n])}return o[0].innerHTML=t,s(o.find("[if]").not(o.find("[each] [if]")),function(t,o){var s=e(o),f=s.attr("if");(f?n(f,r,a,i):void 0)||s.remove()}),s(o.find("[show]").not(o.find("[each] [if]")),function(t,o){var s=e(o),f=s.attr("jshow"),u=f?n(f,r,a,i):void 0;s.addClass(u?"show":"hide"),s.removeClass(u?"hide":"show")}),s(o.find("[jclass]").not(o.find("[each] [if]")),function(t,o){var s=e(o),f=s.attr("jclass"),u=f?n(f,r,a,i):void 0;for(theClass in u)u[theClass]?s.addClass(theClass):s.removeClass(theClass)}),s(o.find("[each]").not(o.find("[each] [each]")),function(t,o){var s=e(o),f=o.innerHTML,u="",c=s.attr("each"),l=c?n(c,r,a,i):void 0;if(l){var d=e.extend({},a),v=0;for(var g in d)0==g.indexOf("index")&&v++;for(var h in l)d["index"+(v||"")]=h,u+=p(f,r,d,i)}o.innerHTML=u}),o[0].innerHTML}(i,o,s,f)).replace(/({{(.*?)}})/g,function(e,r,a,i,u){return t(n(a,o,s,f),!0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}))}function v(e,n){return void 0===n?f[0].hasAttribute(e)?function(e){if("string"!=typeof e)return e;if(e.length){try{return JSON.parse(e)}catch(e){}if(parseInt(e).toString()===e)return parseInt(e);if(parseFloat(e).toString()===e)return parseFloat(e);if("undefined"!==e)return e}}(f.attr(e)):s.data[e]:(s.data[e]=n,void 0!==o[e]&&f.attr(e,t(n,!0)),n)}return o.templateId=u,(s={update:l,updateInternal:function(){},refresh:function(){return s.updateInternal(),s.update(),s},onUpdate:function(e){return s.onUpdateCallback=e,s},onUpdateCallback:function(){return s},set:function(e,t){return v(e,t),s.refresh(),s},get:v,renderer:p,tpl:d}).data=e.extend({},o),s.data=e.extend({},o,function(){var e={};for(var t in o)e[t]=v(t);return e}(),i,{container:f[0],initialContent:f[0].innerHTML}),v("template",d()),function(){for(var e in o)v(e,s.data[e])}(),setTimeout(function(){s.update()}),s}}(jQuery);