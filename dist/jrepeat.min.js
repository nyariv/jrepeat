!function(e){"use strict";function t(e,t){switch(typeof e){case"object":return JSON.stringify(e);case"undefined":return t?"":"undefined";case"null":return"null";case"string":return t?e:'"'+e.replace(/"/g,'\\"')+'"';default:return e.toString()}}function n(t,n,r,a){if(t){r=r||{},a=a||{};var i=t,o={};for(var s in o.$self=n,r)o["$"+s]=r[s];var u=e.extend({},"object"==typeof n?n:{},o,a),c=[];i=i.replace(/(\w\[)?'.*?(?<!\\)'/g,function(e,t,n,r){return t?e:(c.push(e),"===-'-===")});var l=[],f=function e(t){for(var n=0,r=0;n<t.length&&r<t.length;)t=t.substring(0,n)+t.substring(n).replace(/([\w\]]\s*([\[\(]))(.+)/,function(t,r,a,i,o,s){var u=e(i);n+=o+/[\[\(]/.exec(t).index+1+u.pos;for(var c=!1,l=0,f=0;f<t.length&&!c;f++)t[f]==a&&l++,t[f]==("["==a?"]":")")&&(--l||(n+=f+1,c=!0));return/\s*\(/.exec(t.substring(n)),r+u.replaced.replace(/(\.?)(?<!['"\d\/])([a-z$_][\.a-z$_\d]*)(\s*\(.*?\))?/gi,function(e,t,n,r,a,i){return("$getVar"==n||"$getFunc"==n)&&r||t?e:(r?"$getFunc('":"$getVar('")+n.replace(/'/,"\\'")+"')"+(r||"")})}),r++;return{replaced:t,pos:n||r}}("a("+(i=i.replace(/(\w\[)?".*?(?<!\\)"/g,function(e,t,n,r){return t?e:(l.push(e),'===-"-===')}))+")").replaced;i=f.substring(2,f.length-1);var p=0;i=i.replace(/===-"-===/g,function(e,t,n){return l[p++]}),p=0,i=i.replace(/===-'-===/g,function(e,t,n){return c[p++]});try{return Function("$getVar","$getFunc",'"use strict"; return '+i+";")(d,function(e){return d(e)||function(){}})}catch(e){if(!~e.message.indexOf("of undefined"))throw console.error(t),e;return}}function d(e){try{return Function("scope","'use strict';  return scope."+e)(u)}catch(e){return}}}e.fn.jRepeat=function(t){var n,r=this;if((t=t||{}).templateId,!t.state)throw new Error("No state specified");var a,i=function(){return!0},o=t.state;function s(){var t=o;c("limit")&&(t=o.slice(c("page")*c("limit"),(c("page")+1)*c("limit")));for(var i="",s=0;s<t.length;s++)i+=l(u(),t[s],{index:s,page:c("page"),limit:c("limit"),length:o.length},c("functions"));r.addClass("jrepeat-processed");var f=e("<div>");return f.append(i),f.html()!=r.html()&&(r.addClass("jrepeat-exit"),r.addClass("jrepeat-transitioning"),r.removeClass("jrepeat-enter"),clearTimeout(a),a=setTimeout(function(){r.removeClass("jrepeat-exit"),r.addClass("jrepeat-enter"),r.html(i),n.onUpdateCallback(r,n),a=setTimeout(function(){r.removeClass("jrepeat-enter"),r.removeClass("jrepeat-transitioning")},c("transitionEnter"))},50+c("transitionExit"))),n}function u(t){t&&(c("template",t),s());var n=void 0;return!n&&c("templateId")&&(n=e("#"+CSS.escape(c("templateId"))).html()),!n&&c("tag")&&(n="<"+escape(c("tag"))+">{{$self}}</"+escape(c("tag"))+">"),!n&&c("template")&&(n=c("template")),n||(n=c("initialContent")),n}n={filter:function(e){i=e,c("page",0),n.refresh()},reset:function(){i=function(){return!0},c("page",0),n.refresh()},nextPage:function(){n.setPage(c("page")+1)},prevPage:function(){n.setPage(c("page")-1)},setPage:function(e){if(c("limit")){var t=Math.floor((o.length-1)/c("limit"));c("page",e<=t?e>=0?e:0:t)}else c("page",0);n.update()},length:function(){return o.length},update:s,updateInternal:function(){o=c("state").filter(i)},tpl:u};var c=(n=e.extend(r.jTemplate(t,{transitionExit:0,transitionEnter:0,limit:0,page:0,tag:void 0}),n)).get,l=n.renderer;return c("template",u()),n},e.fn.jTemplate=function(r,a){var i;a=a||{};var o=this,s=(r=r||{}).templateId,u=r.state;if(r.functions=r.functions||{},s?e("#"+CSS.escape(s)).html():r.template,!u)throw new Error("No state specified");function c(){var t=e("<div></div>");return t.append(f(l(),p("state"),{},p("functions"))),t.html()!==o.html()&&(o.html(t.html()),i.onUpdateCallback(o,i)),i}function l(t){return t&&(p("template",t),c()),p("template")?p("template"):s?e("#"+CSS.escape(s)).html():o.html()}function f(r,a,i,o){var s,u,c,l,p;return s=r,u=a,c=i,l=o,(p=e("<div></div>")).html(s),p.find("[if]").not(p.find("[each] [if]")).each(function(t,r){var a=e(r),i=a.attr("if");(i?n(i,u,c,l):void 0)||a.remove()}),p.find("[show]").not(p.find("[each] [if]")).each(function(t,r){var a=e(r),i=a.attr("jshow"),o=i?n(i,u,c,l):void 0;a.addClass(o?"show":"hide"),a.removeClass(o?"hide":"show")}),p.find("[jclass]").not(p.find("[each] [if]")).each(function(t,r){var a=e(r),i=a.attr("jclass"),o=i?n(i,u,c,l):void 0;for(theClass in o)o[theClass]?a.addClass(theClass):a.removeClass(theClass)}),p.find("[each]").not(p.find("[each] [each]")).each(function(t,r){var a=e(r),i=a.html();a.empty();var o=a.attr("each"),s=o?n(o,u,c,l):void 0;if(s){var p=e.extend({},c),d=0;for(var g in p)0==g.indexOf("index")&&d++;for(var h in s)p["index"+(d||"")]=h,a.append(f(i,u,p,l))}}),(r=p.html()).replace(/({{(.*?)}})/g,function(e,r,s,u,c){return t(n(s,a,i,o),!0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")})}function p(e,n){return void 0===n?o[0].hasAttribute(e)?function(e){if("string"!=typeof e)return e;if(e.length){try{var t=e;return"'"==e[0]&&"'"==e[e.length-1]&&(t='"'+e.substring(1,e.length-1).replace(/\\\\/g,"__--__").replace(/"/g,'\\"').replace(/\\'/g,"'").replace(/__--__/g,"\\\\")+'"'),JSON.parse(t)}catch(e){}return parseInt(e).toString()===e?parseInt(e):parseFloat(e).toString()===e?parseFloat(e):"true"==e||"false"!=e&&e}}(o.attr(e)):i.data[e]:(i.data[e]=n,void 0!==a[e]&&o.attr(e,t(n,!0)),n)}return a.templateId=s,(i={update:c,updateInternal:function(){},refresh:function(){return i.updateInternal(),i.update(),i},onUpdate:function(e){return i.onUpdateCallback=e,i},onUpdateCallback:function(){return i},set:function(e,t){return p(e,t),i.refresh(),i},get:p,renderer:f,tpl:l}).data=e.extend({},a),i.data=e.extend({},a,function(){var e={};for(var t in a)e[t]=p(t);return e}(),r,{container:o[0],initialContent:o.html()}),p("template",l()),function(){for(var e in a)p(e,i.data[e])}(),setTimeout(function(){i.update()}),i}}(jQuery);